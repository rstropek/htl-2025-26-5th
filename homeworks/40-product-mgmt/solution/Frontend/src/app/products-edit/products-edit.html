<div class="edit-container">
  <h1>Edit Product</h1>

  @if (loading()) {
  <p class="loading">Loading...</p>
  } @else if (error()) {
  <p class="error">{{ error() }}</p>
  } @else {
  <form #productForm="ngForm" (ngSubmit)="onSubmit()" class="edit-form">
    <div class="form-grid">
      <div class="form-group">
        <label for="productCode">Product Code:</label>
        <input
          type="text"
          id="productCode"
          name="productCode"
          [(ngModel)]="productCode"
          required
          maxlength="10"
          #productCodeField="ngModel"
          [class.invalid]="productCodeField.invalid && productCodeField.touched"
        />
        @if (productCodeField.invalid && productCodeField.touched) {
        <span class="error-message">Product code is required (max 10 characters)</span>
        }
      </div>

      <div class="form-group">
        <label for="productName">Product Name:</label>
        <input
          type="text"
          id="productName"
          name="productName"
          [(ngModel)]="productName"
          required
          maxlength="100"
          #productNameField="ngModel"
          [class.invalid]="productNameField.invalid && productNameField.touched"
        />
        @if (productNameField.invalid && productNameField.touched) {
        <span class="error-message">Product name is required (max 100 characters)</span>
        }
      </div>

      <div class="form-group">
        <label for="category">Category:</label>
        <input
          type="text"
          id="category"
          name="category"
          [(ngModel)]="category"
          maxlength="50"
          #categoryField="ngModel"
          [class.invalid]="categoryField.invalid && categoryField.touched"
        />
        @if (categoryField.invalid && categoryField.touched) {
        <span class="error-message">Category must not exceed 50 characters</span>
        }
      </div>

      <div class="form-group">
        <label for="pricePerUnit">Price Per Unit:</label>
        <input
          type="number"
          id="pricePerUnit"
          name="pricePerUnit"
          [(ngModel)]="pricePerUnit"
          required
          min="0.01"
          step="0.01"
          #priceField="ngModel"
          [class.invalid]="priceField.invalid && priceField.touched"
        />
        @if (priceField.invalid && priceField.touched) {
        <span class="error-message">Price per unit is required and must be greater than zero</span>
        }
      </div>

      <div class="form-group full-width">
        <label for="productDescription">Description:</label>
        <textarea
          id="productDescription"
          name="productDescription"
          [(ngModel)]="productDescription"
          rows="4"
          maxlength="255"
          #descriptionField="ngModel"
        ></textarea>
        @if (descriptionField.invalid && descriptionField.touched) {
        <span class="error-message">Description must not exceed 255 characters</span>
        }
      </div>
    </div>

    @if (error()) {
    <p class="form-error">{{ error() }}</p>
    }

    <div class="form-actions">
      <button type="submit" [disabled]="productForm.invalid || saving()">
        {{ saving() ? 'Saving...' : 'Save' }}
      </button>
      <button type="button" class="cancel" (click)="cancel()" [disabled]="saving()">Cancel</button>
    </div>
  </form>
  }
</div>
