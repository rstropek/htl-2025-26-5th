<h2>Secrets Management</h2>

<div class="form-container">
  <label for="connectionString">Connection String:</label>
  <input
    type="text"
    id="connectionString"
    [(ngModel)]="newConnectionString"
    placeholder="Enter connection string"
    [disabled]="loading()"
  />
  <button (click)="addSecret()" [disabled]="loading() || !newConnectionString()">Add Secret</button>
</div>

@if (loading()) {
  <p class="loading">Loading...</p>
}

@if (error()) {
  <div class="error">
    <strong>Error:</strong> {{ error() }}
  </div>
}

@if (secrets()) {
  <div class="results">
    <h3>Secrets ({{ secrets()?.length }})</h3>
    @if (secrets()?.length === 0) {
      <p>No secrets found.</p>
    } @else {
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Connection String</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (secret of secrets(); track secret.id) {
            <tr>
              <td>{{ secret.id }}</td>
              <td>{{ secret.connectionString }}</td>
              <td>
                <button (click)="deleteSecret(secret.id)" [disabled]="loading()">Delete</button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    }
  </div>
}
